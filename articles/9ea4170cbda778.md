---
title: "vscode ã§ Docker ãªé–‹ç™ºç’°å¢ƒã‚’ä½¿ã†"
emoji: "ğŸ³"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [docker,vscode,devcontainer]
published: false
---

## Visual Studio Code ã§ Docker ãªé–‹ç™ºç’°å¢ƒã‚’ä½¿ã†

æ‹¡å¼µæ©Ÿèƒ½ Dev Container ã‚’ä½¿ã£ã¦ä»¥ä¸‹ã®ã“ã¨ãŒã§ãã‚‹ã€‚

* [ ] Dev Container æ‹¡å¼µã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
* [ ] Docker ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’èª­ã¿è¾¼ã¿æ¥ç¶šã™ã‚‹
* [ ] ãƒ­ãƒ¼ã‚«ãƒ«PCã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒŠå†…ã®ãƒãƒ¼ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹
* [ ] ã‚³ãƒ³ãƒ†ãƒŠç’°å¢ƒã«ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’è¿½åŠ ã™ã‚‹

### å‰ææ¡ä»¶

1.  Docker ãŒä½¿ãˆã‚‹
 > $ docker --version
2. Dev Container æ‹¡å¼µãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹

### Quick Start

1. ã‚³ãƒãƒ³ãƒ‰ãƒ‘ãƒ¬ãƒƒãƒˆã‹ã‚‰ **Dev Containers** ã‚³ãƒãƒ³ãƒ‰ã‚’é–‹ãã€ãã“ã‹ã‚‰ã€ŒTry a Dev Container Sample...ã€ã‚’å®Ÿè¡Œã—ã¦ã€ã‚µãƒ³ãƒ—ãƒ«ã‚’é–‹ãã€‚
2. ã‚³ãƒ³ãƒ†ãƒŠãŒä½œæˆã•ã‚Œã‚‹ã®ã‚’å¾…ã¤
3. ã‚³ãƒ³ãƒ†ãƒŠã‚’ç¢ºèªã™ã‚‹
4.  ã€Œå®Ÿè¡Œä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã«ã‚¢ã‚¿ãƒƒãƒã€ã§èµ·å‹•ã•ã‚Œã¦ã„ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶šã™ã‚‹ã€‚ä»¥ä¸‹ã¯Pythonã®å ´åˆã€‚
```shell
$ cd /workspaces/vscode-remote-try-python
$ pip3 install -r requirements.txt
$ python -m flask run
```
ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€ŒVS Code can do that?ã€€Yes it can!ã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚
5. ã€ŒFile>Close Remote Connection(ãƒ•ã‚¡ã‚¤ãƒ«>ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶šã‚’é–‰ã˜ã‚‹)ã€ã§ã‚³ãƒ³ãƒ†ãƒŠã‚’çµ‚äº†ã™ã‚‹ã€‚

### ç¨¼åƒã®ä»•çµ„ã¿

Dev Containersã‚¨ã‚¯ã‚¹ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ãŒã‚³ãƒ³ãƒ†ãƒŠã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¦è¨­å®šæ–¹æ³•è©³ç´°ã€‚

![Alt text](https://code.visualstudio.com/assets/docs/remote/remote-overview/architecture.png)

Dev Container ã¯ **.devcontainer** ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ã€

 * devcontainer.json
 * Dokerfile(or docker-compose.yml)

ã‚’ä½¿ã£ã¦ Dev Container ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚

ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦åˆ©ç”¨ã—ãŸã‚‚ã®ã¯ã‚‚ã®ã¯ [github](https://github.com/devcontainers/features.git)ã«å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ image ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ã€‚

#### devcontainer.json

devcontainer.json ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠã®æ§‹ç¯‰ã¨èµ·å‹•æ³•ã‚’å®šç¾©ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã«ãªã£ã¦ã„ã‚‹ã€‚

```json
{
    "build": {
        "dockerfile": "./Dockerfile",
        "context": "."
    },
    "features": {
        "ghcr.io/devcontainers/features/common-utils:2":{
            "installZsh": "true",
            "username": "vscode",
            "userUid": "1000",
            "userGid": "1000",
            "upgradePackages": "true"
        },
        "ghcr.io/devcontainers/features/python:1": "none",
        "ghcr.io/devcontainers/features/node:1": "none",
        "ghcr.io/devcontainers/features/git:1": {
            "version": "latest",
            "ppa": "false"
        }
    },
 // Configure tool-specific properties.
 "customizations": {
  // Configure properties specific to VS Code.
  "vscode": {
   // Set *default* container specific settings.json values on container create.
   "settings": {
    "python.defaultInterpreterPath": "/usr/local/bin/python"
   }
  }
 },
 // Use 'forwardPorts' to make a list of ports inside the container available locally.
 // "forwardPorts": [],

 // Use 'postCreateCommand' to run commands after the container is created.
 // "postCreateCommand": "pip3 install --user -r requirements.txt",

 // Set `remoteUser` to `root` to connect as root instead. More info: https://aka.ms/vscode-remote/containers/non-root.
 "remoteUser": "vscode"
}
```

ä¸»ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯æ¬¡ã®é€šã‚Šï¼ˆ[è©³ç´°](https://containers.dev/implementors/json_reference/)ã‚’å‚ç…§ï¼‰ã€‚

| option | èª¬æ˜ |
|--- |--- |
| image | ã‚³ãƒ³ãƒ†ãƒŠã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æŒ‡å®šã™ã‚‹ã€‚ |
| dockerfile | Dockerfile ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã™ã‚‹ã€‚ |
| [features](git@github.com:devcontainers/features.git) | ã‚³ãƒ³ãƒ†ãƒŠã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ©Ÿèƒ½ã‚’æŒ‡å®šã™ã‚‹ã€‚ |
| customizations | VS Code ã®è¨­å®šã‚’æŒ‡å®šã™ã‚‹ã€‚ |
| settings | setting.json ã®è¨­å®šã‚’æŒ‡å®šã™ã‚‹ã€‚ |
| forwordPorts | ãƒ—ãƒ©ã‚¤ãƒãƒªã‚³ãƒ³ãƒ†ãƒŠå†…ã‹ã‚‰ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ã¸å¸¸ã«è»¢é€ã™ã¹ããƒãƒ¼ãƒˆç•ªå· |
| portsAttributes | ãƒãƒ¼ãƒˆã®å±æ€§ã‚’æŒ‡å®šã™ã‚‹ã€‚ |
| postCreateCommand | ã‚³ãƒ³ãƒ†ãƒŠä½œæˆå¾Œã«å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’æŒ‡å®šã™ã‚‹ã€‚ |
| remoteUser | ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶šã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æŒ‡å®šã™ã‚‹ã€‚ |

### ç¨¼åƒä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã«ã‚¢ã‚¿ãƒƒãƒã™ã‚‹
